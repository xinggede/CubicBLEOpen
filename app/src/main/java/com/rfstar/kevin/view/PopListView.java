package com.rfstar.kevin.view;import android.content.Context;import android.view.LayoutInflater;import android.view.View;import android.view.View.OnClickListener;import android.view.ViewGroup.LayoutParams;import android.widget.AdapterView;import android.widget.AdapterView.OnItemClickListener;import android.widget.LinearLayout;import android.widget.ListView;import android.widget.PopupWindow;import android.widget.PopupWindow.OnDismissListener;import android.widget.TextView;import com.rfstar.kevin.R;import com.rfstar.kevin.adapter.ModuleAdapter;import com.rfstar.kevin.params.SetItem;import java.util.ArrayList;/** * popwindow + ListView * * @author kevin.wu */public class PopListView extends PopView implements OnItemClickListener,        OnDismissListener {    public PopChioceListViewClickListener listener = null;    private LinearLayout bgLayout = null;    private ListView listView = null;    private TextView title = null;    private ArrayList<SetItem> array = null;    private ModuleAdapter adapter;    private String type;// 列表的类型    /**     * @param context     * @param array        //数据源     * @param parentLayout //父view pop显示时依托的父view     */    public PopListView(Context context, View parentLayout,                       ArrayList<SetItem> array) {        super(context, parentLayout);        this.array = array;        this.initView();    }    public void setTitle(String title) {        this.title.setText(title);    }    /**     * 设置类型     */    public void setType(String type) {        this.type = type;    }    /**     * popPicker中的item事件     *     * @param listener     */    public void setOnPopListViewListener(PopChioceListViewClickListener listener) {        this.listener = listener;    }    private void initView() {        LayoutInflater layoutInflater = LayoutInflater.from(context);        View contentView = layoutInflater.inflate(R.layout.pop_list_view,                null);        adapter = new ModuleAdapter(this.context, array);        this.bgLayout = (LinearLayout) contentView                .findViewById(R.id.listbgLayout);        this.title = (TextView) contentView.findViewById(R.id.listTitle);        this.listView = (ListView) contentView.findViewById(R.id.list);        this.listView.setOnItemClickListener(this);        this.listView.setAdapter(adapter);        // listView.setChoiceMode(ListView.CHOICE_MODE_MULTIPLE);        pop = new PopupWindow(contentView, LayoutParams.MATCH_PARENT,                LayoutParams.MATCH_PARENT, true);        pop.setOnDismissListener(this);        setPopView();        this.bgLayout.setOnClickListener(new OnClickListener() {            @Override            public void onClick(View v) {                // TODO Auto-generated method stub                pop.dismiss();            }        });    }    public interface PopChioceListViewClickListener {        /**         * list item中的事件         *         * @param view         * @param type         */        public void onPopItemClick(View view, String type, int position);    }    @Override    public void onItemClick(AdapterView<?> parent, View view, int position,                            long id) {        // TODO Auto-generated method stub        if (listener != null) {            listener.onPopItemClick(view, type, position);            this.dismiss();        }    }    @Override    public void onDismiss() {        // TODO Auto-generated method stub    }}